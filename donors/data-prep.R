library(dplyr)
library(stringr)
setwd("/Users/raph/Rwork")
schools <- read.csv(file = 'Schools.csv') %>% filter(School.City != "") %>% filter(School.County != "") %>% filter(!str_detect(School.Name,"\""))
nrow(schools)
colnames(schools)
zip <- read.csv(file = 'zip_lat_long.csv')
schools$School.Zip <- as.integer (schools$School.Zip)
schools <- filter(schools,!is.na(School.Zip))
schoolsgeo <-  inner_join(schools, zip, by = c("School.Zip" = "ZIP"))
write.csv(schoolsgeo,'Schools-large.csv', row.names = FALSE ,quote=TRUE)
projects <- read.csv(file = 'Projects.csv')  %>% filter(str_starts(Project.Grade.Level.Category, "Grades")) %>% filter(str_detect(Project.ID,"^.{32}$"))
projectslight <-  inner_join(projects,schools, by = "School.ID") %>% select (colnames(projects)) %>% select( -Project.Essay)
write.csv(projectslight,'Projects-large.csv', row.names = FALSE ,quote=TRUE)
donations <- read.csv(file = 'Donations.csv') %>% filter(Donation.ID!="")
donationslight <-  inner_join(donations,select(projectslight,Project.ID) , by = "Project.ID")
write.csv(donationslight,'Donations-large.csv', row.names = FALSE ,quote=TRUE)
donors <- read.csv(file = 'Donors.csv')
donorslight <- inner_join(donors,select(donationslight,Donor.ID) , by = "Donor.ID")
write.csv(donorslight,'Donors-large.csv', row.names = FALSE ,quote=TRUE)
